#!/usr/bin/env python3

#Get the list of CVEs
import sys
import pandas as pd
from traceback import format_exc

from sqlalchemy import null
if sys.version_info[0] < 3:
    raise Exception("Use Python 3:  python3 " + sys.argv[0])
import requests
import re
import os
from lxml import etree

# Specify/get the url to scrape (included a default for easier testing)
### there is no input validation taking place here ###
urls = {"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=android"}

# CVE regular expression
cve_pattern = r'CVE-\d{4}-\d{4,7}'
cves = null

# for each url get the CVEs matching the RegEx
for url in urls:   
    # query the website and return the html
    page = requests.get(url)
    table = pd.read_html(page.content)
    cves = table[2]
    
path = "./Android CVEs"

for index, row in cves.iterrows():
    os.makedirs(os.path.join(path, str(row['Name'])), exist_ok=True)
    #create and write text to a file in python?
    #print(row)
    filepath = os.path.join(path,str(row['Name']), (str(row['Name']) +'.md'))
    print(filepath)
    with open(filepath , "w") as file:
        file.write(str(row['Description']))













